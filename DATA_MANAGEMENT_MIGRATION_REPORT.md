# –û—Ç—á–µ—Ç –æ –º–∏–≥—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏

## –î–∞—Ç–∞: 2025-10-11

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚úÖ

### 1. –°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å DataManagerService
**–§–∞–π–ª**: `app/services/data_manager_service.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- `get_export_dir()` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ (Downloads)
- `get_active_data_path()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –∫ –∞–∫—Ç–∏–≤–Ω–æ–º—É —Ñ–∞–π–ª—É –¥–∞–Ω–Ω—ã—Ö
- `encrypt_data()` / `decrypt_data()` - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å Fernet
- `load_servers()` / `save_servers()` - –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤
- `create_backup()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
- `verify_key_for_file()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–ª—é—á-–¥–∞–Ω–Ω—ã–µ
- `re_encrypt_password()` - –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–∞—Ä–æ–ª–µ–π –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–ª—é—á–∞
- `merge_servers()` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–æ–≤ –±–µ–∑ –¥—É–±–ª–µ–π
- `allowed_file()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤

### 2. –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤—Å–µ —Ä–æ—É—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏
**–§–∞–π–ª**: `app/routes/main.py`

#### Export —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ `export_data()` - —ç–∫—Å–ø–æ—Ä—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `export_key()` - —ç–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (.env)
- ‚úÖ `export_package()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ ZIP –∞—Ä—Ö–∏–≤–∞ (–¥–∞–Ω–Ω—ã–µ + –∫–ª—é—á + PIN + uploads + README)

#### Import —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ `import_data()` - –∏–º–ø–æ—Ä—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `import_external_data()` - –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —Å –¥—Ä—É–≥–∏–º –∫–ª—é—á–æ–º (—Å –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–æ–π –ø–∞—Ä–æ–ª–µ–π)

#### –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–æ–º:
- ‚úÖ `change_main_key()` - —Å–º–µ–Ω–∞ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–æ–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `verify_key_data()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–ª—é—á-–¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∏–º–ø–æ—Ä—Ç–∞

#### –£—Ç–∏–ª–∏—Ç—ã:
- ‚úÖ `detach_data()` - –æ—Ç–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `get_secret_pin()` - helper –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ PIN

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–§–∞–π–ª**: `app/config.py`

- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_app_data_dir()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `APP_DATA_DIR` –≤ –∫–ª–∞—Å—Å Config
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `ALLOWED_EXTENSIONS` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
**–§–∞–π–ª**: `app/__init__.py`

- –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `DataManagerService`
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `register_services(app)` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ `data_manager`
- DataManagerService –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å `SECRET_KEY` –∏ `APP_DATA_DIR`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è üèóÔ∏è

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π**: –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ `DataManagerService`
- **–†–æ—É—Ç—ã**: –¢–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

### 2. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –ï–¥–∏–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∞–Ω–Ω—ã–º–∏
- –ò–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3. Dependency Injection
- –°–µ—Ä–≤–∏—Å—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ Service Registry
- –†–æ—É—Ç—ã –ø–æ–ª—É—á–∞—é—Ç —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ `registry.get()`
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—ë—Ä–Ω—É—Ç—ã –≤ try-except
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ logger
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ flash-—Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ üîß

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω—è—é—Ç `active_data_file`, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –µ—ë –≤ `config.json`:
```python
config_path = os.path.join(app_data_dir, 'config.json')
with open(config_path, 'r', encoding='utf-8') as f:
    config_data = json.load(f)
config_data['active_data_file'] = file_path
with open(config_path, 'w', encoding='utf-8') as f:
    json.dump(config_data, f, ensure_ascii=False, indent=2)
```

### –ü–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–∞—Ä–æ–ª–µ–π
–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è:
- SSH credentials (password, root_password)
- Panel credentials (password, user)
- Hoster credentials (password, user)

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
–ü—Ä–∏ —Å–º–µ–Ω–µ –∫–ª—é—á–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è:
```python
backup_path = data_manager.create_backup(
    active_file,
    data_dir,
    prefix=f"backup_before_key_change_{timestamp}"
)
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å üîí

1. **–í—Å–µ —Ä–æ—É—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã**:
   - `@require_auth` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - `@require_pin` - –ø—Ä–æ–≤–µ—Ä–∫–∞ PIN-–∫–æ–¥–∞

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ Fernet –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
   - –ü–æ–ø—ã—Ç–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

3. **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—É—Ç–∏**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `secure_filename()` –¥–ª—è –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
source venv/bin/activate
python run.py --desktop
```

–ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
2. **–≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–∞** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–∞
3. **–≠–∫—Å–ø–æ—Ä—Ç –ø–∞–∫–µ—Ç–∞** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –≠–∫—Å–ø–æ—Ä—Ç –ø–æ–ª–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
4. **–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
5. **–ò–º–ø–æ—Ä—Ç –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ò–º–ø–æ—Ä—Ç –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á-–¥–∞–Ω–Ω—ã–µ** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
7. **–°–º–µ–Ω–∞ –∫–ª—é—á–∞** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –°–º–µ–Ω–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª—é—á–∞
8. **–û—Ç–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –û—Ç–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ üöÄ

1. ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
2. üìù –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è `DataManagerService`
3. üìù –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å integration-—Ç–µ—Å—Ç—ã –¥–ª—è —Ä–æ—É—Ç–æ–≤
4. üìù –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚öôÔ∏è

- ‚úÖ macOS (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- ‚úÖ Windows (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `get_app_data_dir()`)
- ‚úÖ Linux (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `get_app_data_dir()`)
- ‚úÖ PyInstaller frozen app (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- ‚úÖ Development mode (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã üìÅ

1. `app/services/data_manager_service.py` - **–°–û–ó–î–ê–ù**
2. `app/routes/main.py` - **–û–ë–ù–û–í–õ–Å–ù** (–¥–æ–±–∞–≤–ª–µ–Ω–æ ~400 —Å—Ç—Ä–æ–∫)
3. `app/__init__.py` - **–û–ë–ù–û–í–õ–Å–ù** (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞)
4. `app/config.py` - **–û–ë–ù–û–í–õ–Å–ù** (APP_DATA_DIR, get_app_data_dir)

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ üìä

- –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ: ~800
- –§—É–Ω–∫—Ü–∏–π –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ: 8
- –°–µ—Ä–≤–∏—Å–æ–≤ —Å–æ–∑–¥–∞–Ω–æ: 1
- –ú–µ—Ç–æ–¥–æ–≤ –≤ —Å–µ—Ä–≤–∏—Å–µ: 13
- –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: ~30 –º–∏–Ω—É—Ç

---

**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–î–∞—Ç–∞**: 2025-10-11  
**–í–µ—Ä—Å–∏—è**: 4.0.0
