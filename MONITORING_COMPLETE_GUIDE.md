# üìö –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ VPN Server Manager

**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0 (Production Ready)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [‚ö†Ô∏è –í–ê–ñ–ù–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –û UFW](#–≤–∞–∂–Ω–æ–µ-–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ-–æ-ufw)
3. [–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)
4. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
5. [–§–∏–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è](#—Ñ–∏–Ω–∞–ª—å–Ω—ã–µ-—É–ª—É—á—à–µ–Ω–∏—è)
6. [–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã](#–∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã)
7. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
8. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
9. [–ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—á–µ–∫–ª–∏—Å—Ç-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

---

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

### –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ VPN —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∞—è:
- üìä Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 5 –º–æ–¥—É–ª–µ–π –¥–∞–Ω–Ω—ã—Ö
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SSH Connection Pooling
- üõ°Ô∏è Rate Limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏
- üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ Health Check endpoints –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É | ~10-15 (–≤ 6-8 —Ä–∞–∑ –º–µ–Ω—å—à–µ!) |
| –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | 30-120 —Å–µ–∫—É–Ω–¥ |
| Rate limiting | 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É |
| Cron —á–∞—Å—Ç–æ—Ç–∞ | –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç —Å flock |
| –ú–æ–¥—É–ª–µ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | 5 (—Ç—Ä–∞—Ñ–∏–∫, firewall, —Å–µ—Ä–≤–∏—Å—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –º–µ—Ç—Ä–∏–∫–∏) |
| API endpoints | 12 |
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ | ‚úÖ 8 —à–∞–≥–æ–≤ —Å real-time –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º |

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –û UFW

> **üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!** –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

### ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ UFW –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º (–Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã - –ù–ï –í–ö–õ–Æ–ß–ê–ô–¢–ï UFW –≤–æ–æ–±—â–µ!**

#### –ü–æ—á–µ–º—É UFW –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∫–ª—é—á–µ–Ω?

1. **–†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ SSH** - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å VPN** - UFW –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º** - –∞–∫—Ç–∏–≤–Ω—ã–π UFW –º–æ–∂–µ—Ç –º–µ—à–∞—Ç—å —Å–±–æ—Ä—É –º–µ—Ç—Ä–∏–∫
4. **–ü–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞** - –µ—Å–ª–∏ UFW –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç 22, –≤—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ SSH –¥–æ—Å—Ç—É–ø –Ω–∞–≤—Å–µ–≥–¥–∞ (–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Å–æ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞)

#### ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ UFW

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@<server_ip>

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å UFW
sudo ufw status

# 3. –ï—Å–ª–∏ UFW –∞–∫—Ç–∏–≤–µ–Ω (Status: active) - –í–´–ö–õ–Æ–ß–ò–¢–ï –µ–≥–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ!
sudo ufw disable

# 4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã–∫–ª—é—á–µ–Ω
sudo ufw status
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: Status: inactive
```

#### üìã –ß—Ç–æ –µ—Å–ª–∏ UFW —É–∂–µ –≤–∫–ª—é—á–µ–Ω?

**–û–°–¢–û–†–û–ñ–ù–û!** –ï—Å–ª–∏ UFW —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω:

```bash
# 1. –°–ù–ê–ß–ê–õ–ê —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ SSH –ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç (–∏–Ω–∞—á–µ –ø–æ—Ç–µ—Ä—è–µ—Ç–µ –¥–æ—Å—Ç—É–ø!)
sudo ufw status numbered

# 2. –ï—Å–ª–∏ –ø–æ—Ä—Ç–∞ 22 –ù–ï–¢ –≤ —Å–ø–∏—Å–∫–µ - –¥–æ–±–∞–≤—å—Ç–µ –ï–ì–û –ù–ï–ú–ï–î–õ–ï–ù–ù–û:
sudo ufw allow 22/tcp
sudo ufw allow ssh

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –µ—â–µ —Ä–∞–∑
sudo ufw status

# 4. –¢–û–õ–¨–ö–û –¢–ï–ü–ï–†–¨ –º–æ–∂–Ω–æ –≤—ã–∫–ª—é—á–∏—Ç—å UFW
sudo ufw disable
```

#### üîí –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ (–±–µ–∑ UFW)

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ –∑–∞—â–∏—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **fail2ban** –≤–º–µ—Å—Ç–æ UFW:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ fail2ban (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
sudo apt-get update
sudo apt-get install -y fail2ban

# fail2ban –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP
# –ù–û –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –∫–∞–∫ UFW
```

#### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å** –¥–∞–∂–µ –µ—Å–ª–∏ UFW –≤–∫–ª—é—á–µ–Ω
- ‚úÖ **–ú–µ—Ç—Ä–∏–∫–∏ —Ñ–∞–π—Ä–≤–æ–ª–∞ –±—É–¥—É—Ç —Å–æ–±–∏—Ä–∞—Ç—å—Å—è** (—Å—Ç–∞—Ç—É—Å, –ø–æ—Ä—Ç—ã, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
- ‚ùå **–ù–û –≤—ã —Ä–∏—Å–∫—É–µ—Ç–µ** –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–µ–±–µ –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- ‚ùå **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞** –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Å–æ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞

#### üìä –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ UFW?

–î–∞–∂–µ —Å –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º UFW, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
- –°—Ç–∞—Ç—É—Å: `inactive` (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!)
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã: –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏: `0` (UFW –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ SSH –ª–æ–≥–∏ –∏ fail2ban

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ‚úÖ

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ **–ü–∞–Ω–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏** —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ **Real-time –ø—Ä–æ–≥—Ä–µ—Å—Å** —Å –ª–æ–≥–∞–º–∏ —á–µ—Ä–µ–∑ Server-Sent Events (SSE)
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã** —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥** –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ **8 —à–∞–≥–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏**:
  1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
  2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
  3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ vnstat
  4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ jq
  5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ net-tools
  6. –ü—Ä–æ–≤–µ—Ä–∫–∞/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW
  7. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ (cron)**
  8. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

### 2. –ü—è—Ç—å –º–æ–¥—É–ª–µ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ‚úÖ

#### üì° –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫
- –¢–µ–∫—É—â–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏/–æ—Ç–¥–∞—á–∏ (MB/s)
- –ü–∏–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ —Å–µ—Å—Å–∏—é
- –°—É—Ç–æ—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å vnstat
- –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

#### üî• –°—Ç–∞—Ç—É—Å —Ñ–∞–π—Ä–≤–æ–ª–∞ (UFW)
- –°—Ç–∞—Ç—É—Å (active/inactive)
- –°–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 24 —á–∞—Å–∞
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π IP –∏ –ø–æ—Ä—Ç

#### ‚öôÔ∏è –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (nginx, apache2, ssh, postgresql, mysql, docker, redis)
- –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (active/inactive)
- Uptime —Å–µ—Ä–≤–∏—Å–∞
- Auto-start —Å—Ç–∞—Ç—É—Å (enabled/disabled)

#### üõ°Ô∏è –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- SSH –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –∑–∞ 24 —á–∞—Å–∞
- –¢–æ–ø-3 IP –∞–¥—Ä–µ—Å–æ–≤ —Å –Ω–µ—É–¥–∞—á–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
- –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –î–Ω–µ–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- –ù–æ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã

#### üìà –ì—Ä–∞—Ñ–∏–∫–∏ CPU –∏ Memory
- –ò—Å—Ç–æ—Ä–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 60 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å Chart.js

### 3. –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚úÖ

- ‚úÖ **–í—ã–µ–∑–∂–∞—é—â–∞—è –ø–∞–Ω–µ–ª—å** —Å–ø—Ä–∞–≤–∞
- ‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏** –∏ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ **5 —à–∞–≥–æ–≤ —É–¥–∞–ª–µ–Ω–∏—è**:
  1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
  2. –ü—Ä–æ–≤–µ—Ä–∫–∞ vnstat
  3. –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  4. **–£–¥–∞–ª–µ–Ω–∏–µ cron –∑–∞–¥–∞—á–∏**
  5. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏

---

## üîí –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1Ô∏è‚É£ SSH Connection Pooling

**–§–∞–π–ª:** `app/services/ssh_service.py`

#### –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

```python
class SSHService:
    # –ö—ç—à –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–∞
    _connection_pool = {}
    _pool_lock = threading.Lock()
    
    @classmethod
    def get_connection_pooled(cls, hostname, port, username, password):
        """–ü–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º"""
        key = f"{hostname}:{port}:{username}"
        
        with cls._pool_lock:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∂–∏–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            if key in cls._connection_pool:
                conn = cls._connection_pool[key]
                if conn.get_transport() and conn.get_transport().is_active():
                    logger.info(f"‚ôªÔ∏è Reusing existing connection to {hostname}")
                    return conn
            
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ
            logger.info(f"üîå Creating new SSH connection to {hostname}")
            ssh = paramiko.SSHClient()
            ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
            ssh.connect(
                hostname, port=port, username=username, password=password,
                timeout=30, banner_timeout=60, auth_timeout=30,
                look_for_keys=False, allow_agent=False
            )
            cls._connection_pool[key] = ssh
            return ssh
    
    @classmethod
    def close_all(cls):
        """–ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (graceful shutdown)"""
        with cls._pool_lock:
            for key, conn in list(cls._connection_pool.items()):
                try:
                    conn.close()
                except:
                    pass
            cls._connection_pool.clear()
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç pooling):
1. ‚úÖ `get_server_stats()`
2. ‚úÖ `get_network_stats()`
3. ‚úÖ `get_firewall_stats()`
4. ‚úÖ `get_services_stats()`
5. ‚úÖ `get_security_events()`
6. ‚úÖ `get_metrics_history()`
7. ‚úÖ `check_required_tools()`

#### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- ‚ôªÔ∏è **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑
- ‚ö° **–ë—ã—Å—Ç—Ä–µ–µ** - –Ω–µ —Ç—Ä–∞—Ç–∏–º –≤—Ä–µ–º—è –Ω–∞ handshake
- üíæ **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞** –Ω–∞ –∫–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ** - –º–µ–Ω—å—à–µ —à–∞–Ω—Å–æ–≤ –ø–æ–ª—É—á–∏—Ç—å –±–∞–Ω –æ—Ç fail2ban

---

### 2Ô∏è‚É£ Rate Limiting

**–§–∞–π–ª:** `app/utils/rate_limiter.py` (–°–û–ó–î–ê–ù)

```python
class RateLimiter:
    """–û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤"""
    
    def __init__(self, max_requests=10, time_window=60):
        self.max_requests = max_requests
        self.time_window = time_window
        self.requests = defaultdict(list)
        self.blocked_count = defaultdict(int)
        self.lock = Lock()
    
    def is_allowed(self, key):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ –ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å"""
        with self.lock:
            now = time.time()
            
            # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã
            self.requests[key] = [
                req_time for req_time in self.requests[key]
                if now - req_time < self.time_window
            ]
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç
            if len(self.requests[key]) >= self.max_requests:
                self.blocked_count[key] += 1
                
                # –õ–æ–≥–∏—Ä—É–µ–º –∫–∞–∂–¥—É—é 10-—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
                if self.blocked_count[key] % 10 == 0:
                    logger.warning(
                        f"üö´ Rate limit exceeded for '{key}' - "
                        f"blocked {self.blocked_count[key]} times"
                    )
                
                return False
            
            self.requests[key].append(now)
            return True
```

**–§–∞–π–ª:** `app/routes/api.py`

```python
# –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç–µ—Ä
rate_limiter = RateLimiter(max_requests=10, time_window=60)

# –ó–∞—â–∏—â–∞–µ–º endpoints
@api_bp.route('/monitoring/<id>/network-stats', methods=['GET'])
@require_auth
@require_pin
def get_network_stats(server_id):
    # Rate limiting
    if not rate_limiter.is_allowed(f"server_{server_id}"):
        return jsonify({
            'success': False,
            'error': 'Rate limit exceeded. Please wait a moment.'
        }), 429
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
```

#### –ó–∞—â–∏—â–µ–Ω–æ (7 endpoints):
1. ‚úÖ `/api/monitoring/<id>/network-stats`
2. ‚úÖ `/api/monitoring/<id>/firewall-stats`
3. ‚úÖ `/api/monitoring/<id>/services-stats`
4. ‚úÖ `/api/monitoring/<id>/security-events`
5. ‚úÖ `/api/monitoring/<id>/metrics-history`
6. ‚úÖ `/api/monitoring/<id>/check-tools`
7. ‚úÖ `/api/monitoring/<id>/check-installed`

#### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- üõ°Ô∏è **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏** - –º–∞–∫—Å–∏–º—É–º 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- üö´ **HTTP 429** –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- üìä **–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–≥—Ä—É–∑–∫–∏** –Ω–∞ SSH —Å–µ—Ä–≤–µ—Ä
- üìù **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∫–∞–∂–¥–æ–π 10-–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

---

### 3Ô∏è‚É£ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–§–∞–π–ª:** `templates/monitoring.html`

```javascript
// ‚ùå –ë–´–õ–û (–æ–ø–∞—Å–Ω–æ):
setInterval(updateNetworkStats, 5000);      // 5 —Å–µ–∫
setInterval(updateFirewallStatus, 10000);   // 10 —Å–µ–∫
setInterval(updateServicesStatus, 10000);   // 10 —Å–µ–∫
setInterval(updateSecurityEvents, 30000);   // 30 —Å–µ–∫
setInterval(updateCharts, 60000);           // 60 —Å–µ–∫

// ‚úÖ –°–¢–ê–õ–û (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
intervals.push(setInterval(updateNetworkStats, 30000));      // 30 —Å–µ–∫
intervals.push(setInterval(updateFirewallStatus, 30000));    // 30 —Å–µ–∫
intervals.push(setInterval(updateServicesStatus, 30000));    // 30 —Å–µ–∫
intervals.push(setInterval(updateSecurityEvents, 60000));    // 60 —Å–µ–∫
intervals.push(setInterval(updateCharts, 120000));           // 120 —Å–µ–∫
```

#### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- üìâ **–í 6 —Ä–∞–∑ –º–µ–Ω—å—à–µ** SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ** - –º–µ–Ω—å—à–µ —à–∞–Ω—Å–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- ‚ö° **–ë—ã—Å—Ç—Ä–µ–µ** - pooled —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∂–∏–≤—É—Ç –¥–æ–ª—å—à–µ
- üíæ **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞

---

### 4Ô∏è‚É£ Graceful Shutdown

**–§–∞–π–ª:** `run.py`

```python
import atexit

@atexit.register
def cleanup():
    """–û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    logger = logging.getLogger(__name__)
    logger.info("üßπ Cleaning up SSH connections...")
    try:
        from app.services.ssh_service import SSHService
        SSHService.close_all()
        logger.info("‚úÖ SSH connections closed")
    except Exception as e:
        logger.warning(f"‚ö†Ô∏è Error during cleanup: {e}")
```

#### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- üßπ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ** –≤—Å–µ—Ö SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
- üìù **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ **–ù–µ—Ç –≤–∏—Å—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π** –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üéØ –§–∏–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 5Ô∏è‚É£ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π Cron —Å flock

**–ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ (—à–∞–≥ 7 –∏–∑ 8):**

```bash
#!/bin/bash
# /usr/local/bin/monitoring/update-metrics-history.sh
HISTORY_FILE="/var/tmp/metrics_history.json"
MAX_POINTS=288  # 24 —á–∞—Å–∞ –∏—Å—Ç–æ—Ä–∏–∏ (288 —Ç–æ—á–µ–∫ √ó 5 –º–∏–Ω—É—Ç)

# –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | sed "s/.*, *\([0-9.]*\)%* id.*/\1/" | awk '{print 100 - $1}')
MEM_USAGE=$(free | grep Mem | awk '{printf "%.1f", $3/$2 * 100}')
TIMESTAMP=$(date +%s)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ jq
if ! command -v jq &> /dev/null; then
    echo "[]" > "$HISTORY_FILE"
    exit 0
fi

# –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
if [ ! -f "$HISTORY_FILE" ]; then
    echo "[]" > "$HISTORY_FILE"
fi

jq ". += [{\"timestamp\":$TIMESTAMP,\"cpu\":$CPU_USAGE,\"memory\":$MEM_USAGE}] | .[-$MAX_POINTS:]" "$HISTORY_FILE" > "$HISTORY_FILE.tmp" && mv "$HISTORY_FILE.tmp" "$HISTORY_FILE"
```

**Cron –∑–∞–¥–∞—á–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è):**

```bash
*/5 * * * * flock -n /var/run/metrics-history.lock /usr/local/bin/monitoring/update-metrics-history.sh > /dev/null 2>&1
```

#### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- ‚è∞ –ó–∞–ø—É—Å–∫ —Ä–∞–∑ –≤ **5 –º–∏–Ω—É—Ç** (–≤–º–µ—Å—Ç–æ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- üîí **flock** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –º–µ–¥–ª–µ–Ω–Ω—ã–π
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** - –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É

**–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
- –°–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è–µ—Ç—Å—è: `sudo rm -rf /usr/local/bin/monitoring`
- Cron –∑–∞–¥–∞—á–∞ —É–¥–∞–ª—è–µ—Ç—Å—è: `crontab -l | grep -v "update-metrics-history.sh" | crontab -`

---

### 6Ô∏è‚É£ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ JavaScript

**–§–∞–π–ª:** `templates/monitoring.html`

```javascript
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let errorCount = 0;
const MAX_ERRORS = 3;
let intervals = [];

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
function handleError(message, context = '') {
    errorCount++;
    console.warn(`‚ö†Ô∏è Error ${errorCount}/${MAX_ERRORS} [${context}]: ${message}`);
    
    if (errorCount >= MAX_ERRORS) {
        console.error('‚ùå Too many errors! Stopping auto-refresh.');
        stopAllIntervals();
        showErrorNotification('–ü–æ—Ç–µ—Ä—è–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.');
    }
}

// –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
function stopAllIntervals() {
    intervals.forEach(interval => clearInterval(interval));
    intervals = [];
}

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
function showErrorNotification(message) {
    const notification = document.createElement('div');
    notification.className = 'alert alert-danger alert-dismissible fade show';
    notification.style.position = 'fixed';
    notification.style.top = '80px';
    notification.style.right = '20px';
    notification.style.zIndex = '9999';
    notification.innerHTML = `
        <div class="d-flex align-items-start">
            <div style="font-size: 2rem; margin-right: 15px;">‚ö†Ô∏è</div>
            <div>
                <strong>–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</strong><br>
                ${message}
                <div class="mt-2">
                    <button class="btn btn-sm btn-primary" onclick="location.reload()">
                        <i class="bi bi-arrow-clockwise"></i> –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    </button>
                </div>
            </div>
        </div>
    `;
    document.body.appendChild(notification);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
async function updateNetworkStats() {
    try {
        const response = await fetch(`/api/monitoring/${serverId}/network-stats`, {
            signal: AbortSignal.timeout(25000) // Timeout 25 —Å–µ–∫
        });
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            errorCount = 0; // –°–±—Ä–æ—Å –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
            // ... –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        } else {
            handleError(data.error || 'Failed to load', 'NetworkStats');
        }
    } catch (error) {
        handleError(error.message, 'NetworkStats');
    }
}
```

#### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- ‚úÖ **–ê–≤—Ç–æ–æ—Å—Ç–∞–Ω–æ–≤–∫–∞** –ø–æ—Å–ª–µ 3 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –∫–Ω–æ–ø–∫–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ **–°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞** –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
- ‚úÖ **Timeout –∑–∞—â–∏—Ç–∞** 25 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å

---

### 7Ô∏è‚É£ Endpoint —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã

**–§–∞–π–ª:** `app/routes/api.py`

```python
@api_bp.route('/monitoring/stats/system', methods=['GET'])
@require_auth
@require_pin
def monitoring_system_stats():
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"""
    from ..services.ssh_service import SSHService
    
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    active_connections = len(SSHService._connection_pool)
    
    # –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    connections = []
    for key, conn in SSHService._connection_pool.items():
        try:
            is_alive = conn.get_transport() and conn.get_transport().is_active()
            connections.append({'key': key, 'alive': is_alive})
        except:
            connections.append({'key': key, 'alive': False})
    
    return jsonify({
        'success': True,
        'stats': {
            'active_ssh_connections': active_connections,
            'connections': connections,
            'connection_pool_enabled': True,
            'rate_limiting_enabled': True,
            'max_requests_per_minute': rate_limiter.max_requests,
            'time_window': rate_limiter.time_window
        }
    })
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "success": true,
  "stats": {
    "active_ssh_connections": 2,
    "connections": [
      {"key": "195.238.122.137:22:root", "alive": true},
      {"key": "10.0.0.1:22:admin", "alive": true}
    ],
    "connection_pool_enabled": true,
    "rate_limiting_enabled": true,
    "max_requests_per_minute": 10,
    "time_window": 60
  }
}
```

---

### 8Ô∏è‚É£ Health Check Endpoint

**–§–∞–π–ª:** `app/routes/api.py`

```python
@api_bp.route('/monitoring/health', methods=['GET'])
def health_check():
    """Health check –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏"""
    import time
    from ..services.ssh_service import SSHService
    
    health = {
        'status': 'healthy',
        'timestamp': int(time.time()),
        'checks': {}
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH Connection Pool
    try:
        pool_size = len(SSHService._connection_pool)
        active_count = sum(1 for k, c in SSHService._connection_pool.items() 
                          if c.get_transport() and c.get_transport().is_active())
        
        health['checks']['ssh_pool'] = {
            'status': 'ok',
            'total_connections': pool_size,
            'active_connections': active_count
        }
    except Exception as e:
        health['checks']['ssh_pool'] = {'status': 'error', 'error': str(e)}
        health['status'] = 'degraded'
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Rate Limiter
    try:
        health['checks']['rate_limiter'] = {
            'status': 'ok',
            'enabled': True,
            'max_requests': rate_limiter.max_requests
        }
    except Exception as e:
        health['checks']['rate_limiter'] = {'status': 'error', 'error': str(e)}
        health['status'] = 'degraded'
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Services
    try:
        ssh_service = registry.get('ssh')
        data_manager = registry.get('data_manager')
        
        health['checks']['services'] = {
            'status': 'ok',
            'ssh_service': ssh_service is not None,
            'data_manager': data_manager is not None
        }
        
        if not ssh_service or not data_manager:
            health['status'] = 'degraded'
    except Exception as e:
        health['checks']['services'] = {'status': 'error', 'error': str(e)}
        health['status'] = 'degraded'
    
    status_code = 200 if health['status'] == 'healthy' else 503
    return jsonify(health), status_code
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (healthy):**

```json
{
  "status": "healthy",
  "timestamp": 1697200000,
  "checks": {
    "ssh_pool": {
      "status": "ok",
      "total_connections": 2,
      "active_connections": 2
    },
    "rate_limiter": {
      "status": "ok",
      "enabled": true,
      "max_requests": 10
    },
    "services": {
      "status": "ok",
      "ssh_service": true,
      "data_manager": true
    }
  }
}
```

**HTTP Status:** 200 (healthy) –∏–ª–∏ 503 (degraded)

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend Files

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –°—Ç—Ä–æ–∫–∏ | –°—Ç–∞—Ç—É—Å |
|------|-----------|--------|--------|
| `app/services/ssh_service.py` | Connection Pooling, timeouts | ~140 | ‚úÖ |
| `app/routes/api.py` | Rate Limiting, Cron, Endpoints | ~200 | ‚úÖ |
| `app/routes/main.py` | –ù–æ–≤—ã–π route `/monitoring/<id>` | +20 | ‚úÖ |
| `app/utils/rate_limiter.py` | **–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª** | +70 | ‚úÖ |
| `run.py` | Graceful Shutdown | +13 | ‚úÖ |

### Frontend Files

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –°—Ç—Ä–æ–∫–∏ | –°—Ç–∞—Ç—É—Å |
|------|-----------|--------|--------|
| `templates/monitoring.html` | **–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª** | +1100 | ‚úÖ |
| `templates/index.html` | –ö–Ω–æ–ø–∫–∞ "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥" | +5 | ‚úÖ |
| `static/css/monitoring.css` | **–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª** | +590 | ‚úÖ |

### API Endpoints

| Endpoint | Method | –û–ø–∏—Å–∞–Ω–∏–µ | Rate Limited |
|----------|--------|----------|--------------|
| `/monitoring/<id>` | GET | –°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | - |
| `/api/monitoring/<id>/check-installed` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ | ‚úÖ |
| `/api/monitoring/<id>/install` | GET (SSE) | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º | - |
| `/api/monitoring/<id>/cancel-install` | POST | –û—Ç–º–µ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ | - |
| `/api/monitoring/<id>/uninstall` | GET (SSE) | –£–¥–∞–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º | - |
| `/api/monitoring/<id>/network-stats` | GET | –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ | ‚úÖ |
| `/api/monitoring/<id>/firewall-stats` | GET | –°—Ç–∞—Ç—É—Å firewall | ‚úÖ |
| `/api/monitoring/<id>/services-stats` | GET | –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ | ‚úÖ |
| `/api/monitoring/<id>/security-events` | GET | –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | ‚úÖ |
| `/api/monitoring/<id>/metrics-history` | GET | –ò—Å—Ç–æ—Ä–∏—è –º–µ—Ç—Ä–∏–∫ | ‚úÖ |
| `/api/monitoring/<id>/check-tools` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–∏–ª–∏—Ç | ‚úÖ |
| `/api/monitoring/stats/system` | GET | **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã** | - |
| `/api/monitoring/health` | GET | **Health Check** | - |

**–ò—Ç–æ–≥–æ:** 13 endpoints, –∏–∑ –Ω–∏—Ö 7 —Å Rate Limiting

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Connection Pooling

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python3 run_desktop.py

# –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è:

# üîå Creating new SSH connection to 195.238.122.137 (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
# ‚ôªÔ∏è Reusing existing connection to 195.238.122.137 (–ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Ä–∞–∑—ã)
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ "Creating" –ø–æ—è–≤–ª—è–µ—Ç—Å—è 1 —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
- ‚úÖ "Reusing" –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–Ω–æ–≥–æ —Ä–∞–∑ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Rate Limiting

```javascript
// –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console
// –í—ã–ø–æ–ª–Ω–∏—Ç–µ 20 –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

Promise.all(
    Array(20).fill().map((_, i) => 
        fetch('/api/monitoring/3/network-stats')
            .then(r => r.json())
            .then(d => ({
                request: i + 1,
                success: d.success,
                error: d.error || 'OK'
            }))
    )
).then(results => {
    console.table(results);
    const successful = results.filter(r => r.success).length;
    const blocked = results.filter(r => r.error.includes('Rate limit')).length;
    console.log(`‚úÖ Successful: ${successful}, ‚ùå Blocked: ${blocked}`);
});
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–µ—Ä–≤—ã–µ 10 –∑–∞–ø—Ä–æ—Å–æ–≤: `success: true`
- ‚ùå –°–ª–µ–¥—É—é—â–∏–µ 10 –∑–∞–ø—Ä–æ—Å–æ–≤: `"Rate limit exceeded"`

**–í –ª–æ–≥–∞—Ö:**
```
WARNING - üö´ Rate limit exceeded for 'server_3' - blocked 10 times (limit: 10 req/60s)
```

---

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network
# –§–∏–ª—å—Ç—Ä: XHR
# –ù–∞–±–ª—é–¥–∞–π—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤:

# - network-stats: –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
# - firewall-stats: –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
# - services-stats: –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
# - security-events: –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
# - metrics-history: –∫–∞–∂–¥—ã–µ 120 —Å–µ–∫—É–Ω–¥
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏
- ‚úÖ –ù–µ —á–∞—â–µ, —á–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ JS

```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
# 2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console
# 3. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ SSH:
ssh root@<server_ip> "sudo ufw deny 22"

# –ß–µ—Ä–µ–∑ ~90 —Å–µ–∫—É–Ω–¥ (3 –ø–æ–ø—ã—Ç–∫–∏ –ø–æ 30 —Å–µ–∫) –≤ –∫–æ–Ω—Å–æ–ª–∏:
# ‚ö†Ô∏è Error 1/3 [NetworkStats]: ...
# ‚ö†Ô∏è Error 2/3 [NetworkStats]: ...
# ‚ö†Ô∏è Error 3/3 [NetworkStats]: ...
# ‚ùå Too many errors! Stopping auto-refresh.
# üõë Stopping all auto-refresh intervals...

# –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ—è–≤–∏—Ç—Å—è alert —Å –∫–Ω–æ–ø–∫–æ–π "–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"

# 4. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ SSH:
ssh root@<server_ip> "sudo ufw allow 22"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ—Å–ª–µ 3 –æ—à–∏–±–æ–∫ –≤—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –ù–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ cron –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ UI
# –ó–∞—Ç–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
ssh root@<server_ip>

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ cron
crontab -l | grep update-metrics-history

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
# */5 * * * * flock -n /var/run/metrics-history.lock /usr/local/bin/monitoring/update-metrics-history.sh > /dev/null 2>&1

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫—Ä–∏–ø—Ç
ls -la /usr/local/bin/monitoring/update-metrics-history.sh
# -rwxr-xr-x 1 root root ... update-metrics-history.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤—Ä—É—á–Ω—É—é
/usr/local/bin/monitoring/update-metrics-history.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
cat /var/tmp/metrics_history.json
# –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è JSON —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏:
# [{"timestamp":1697200000,"cpu":15.3,"memory":45.2}]
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Cron –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (*/5)
- ‚úÖ –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ JSON —Ñ–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

---

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ Graceful Shutdown

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python3 run_desktop.py

# –û—Ç–∫—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
# –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥ (—á—Ç–æ–±—ã —Å–æ–∑–¥–∞–ª–∏—Å—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Ctrl+C)

# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
# üßπ Cleaning up SSH connections...
# Closing connection: 195.238.122.137:22:root
# ‚úÖ SSH connections closed
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
- ‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

---

### 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã

```bash
# –í –±—Ä–∞—É–∑–µ—Ä–µ –æ—Ç–∫—Ä–æ–π—Ç–µ:
http://127.0.0.1:5000/api/monitoring/stats/system

# –ò–ª–∏ —á–µ—Ä–µ–∑ curl:
curl -H "Cookie: pin_authenticated=true" \
     http://127.0.0.1:5000/api/monitoring/stats/system | jq
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "stats": {
    "active_ssh_connections": 2,
    "connections": [...],
    "connection_pool_enabled": true,
    "rate_limiting_enabled": true,
    "max_requests_per_minute": 10,
    "time_window": 60
  }
}
```

---

### 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ Health Check

```bash
# –í –±—Ä–∞—É–∑–µ—Ä–µ:
http://127.0.0.1:5000/api/monitoring/health

# –ò–ª–∏ —á–µ—Ä–µ–∑ curl:
curl -v http://127.0.0.1:5000/api/monitoring/health | jq

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ HTTP —Å—Ç–∞—Ç—É—Å:
# HTTP/1.1 200 OK (–µ—Å–ª–∏ healthy)
# HTTP/1.1 503 Service Unavailable (–µ—Å–ª–∏ degraded)
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (healthy):**
```json
{
  "status": "healthy",
  "timestamp": 1697200000,
  "checks": {
    "ssh_pool": {"status": "ok", ...},
    "rate_limiter": {"status": "ok", ...},
    "services": {"status": "ok", ...}
  }
}
```

---

### 9. –¢–µ—Å—Ç –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ 5 –≤–∫–ª–∞–¥–æ–∫ –±—Ä–∞—É–∑–µ—Ä–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
# 2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5 –º–∏–Ω—É—Ç
# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

ssh root@<server_ip>

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1-2, –Ω–µ 10-20!)
netstat -tn | grep :22 | wc -l

# –ü—Ä–æ—Ü–µ—Å—Å—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–∞)
ps aux | grep monitoring

# –ù–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã (load average < 1.0)
uptime

# –õ–æ–≥–∏ fail2ban (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤–∞—à–µ–≥–æ IP)
sudo fail2ban-client status sshd
```

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π: 1-2
- ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞: 0-1
- ‚úÖ Load average: < 1.0
- ‚úÖ –í–∞—à IP –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

---

## üìû –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –î–ª—è –ù–û–í–´–• —Å–µ—Ä–≤–µ—Ä–æ–≤

‚úÖ **–í—Å—ë –≥–æ—Ç–æ–≤–æ!** –ü—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ UI:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–µ—Ä–≤–µ—Ä–∞
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
3. –ù–∞–∂–º–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (8 —à–∞–≥–æ–≤)
5. –ì–æ—Ç–æ–≤–æ! Cron —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

### –î–ª—è –°–£–©–ï–°–¢–í–£–Æ–©–ò–• —Å–µ—Ä–≤–µ—Ä–æ–≤

**–í–ê–ñ–ù–û:** –°–µ—Ä–≤–µ—Ä—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, **–Ω–µ –∏–º–µ—é—Ç** cron –∑–∞–¥–∞—á–∏!

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –í UI:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (‚öôÔ∏è)
2. –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
4. –ù–∞–∂–º–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥" —Å–Ω–æ–≤–∞
5. –ì–æ—Ç–æ–≤–æ! –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å cron —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ cron

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@<server_ip>

# 2. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
sudo mkdir -p /usr/local/bin/monitoring

# 3. –°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç
sudo tee /usr/local/bin/monitoring/update-metrics-history.sh > /dev/null <<'EOF'
#!/bin/bash
HISTORY_FILE="/var/tmp/metrics_history.json"
MAX_POINTS=288  # 24 —á–∞—Å–∞ –∏—Å—Ç–æ—Ä–∏–∏ (288 —Ç–æ—á–µ–∫ √ó 5 –º–∏–Ω—É—Ç)

CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | sed "s/.*, *\([0-9.]*\)%* id.*/\1/" | awk '{print 100 - $1}')
MEM_USAGE=$(free | grep Mem | awk '{printf "%.1f", $3/$2 * 100}')
TIMESTAMP=$(date +%s)

if ! command -v jq &> /dev/null; then
    echo "[]" > "$HISTORY_FILE"
    exit 0
fi

if [ ! -f "$HISTORY_FILE" ]; then
    echo "[]" > "$HISTORY_FILE"
fi

jq ". += [{\"timestamp\":$TIMESTAMP,\"cpu\":$CPU_USAGE,\"memory\":$MEM_USAGE}] | .[-$MAX_POINTS:]" "$HISTORY_FILE" > "$HISTORY_FILE.tmp" && mv "$HISTORY_FILE.tmp" "$HISTORY_FILE"
EOF

# 4. –°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
sudo chmod +x /usr/local/bin/monitoring/update-metrics-history.sh

# 5. –î–æ–±–∞–≤—å—Ç–µ cron
(crontab -l 2>/dev/null | grep -v "update-metrics-history.sh"; echo "*/5 * * * * flock -n /var/run/metrics-history.lock /usr/local/bin/monitoring/update-metrics-history.sh > /dev/null 2>&1") | crontab -

# 6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
crontab -l | grep update-metrics-history
```

---

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

#### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Health Check endpoint

```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Uptime Robot):
# URL: https://your-domain.com/api/monitoring/health
# –ú–µ—Ç–æ–¥: GET
# –û–∂–∏–¥–∞–µ–º—ã–π —Å—Ç–∞—Ç—É—Å: 200
# –ü—Ä–æ–≤–µ—Ä–∫–∞: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ curl –≤ cron:
*/5 * * * * curl -f https://your-domain.com/api/monitoring/health > /dev/null 2>&1 || echo "VPN Manager monitoring is down!" | mail -s "Alert" admin@example.com
```

#### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tail -f logs/app.log

# –§–∏–ª—å—Ç—Ä –ø–æ –æ—à–∏–±–∫–∞–º
tail -f logs/app.log | grep ERROR

# –§–∏–ª—å—Ç—Ä –ø–æ Rate Limit
tail -f logs/app.log | grep "Rate limit"

# –§–∏–ª—å—Ç—Ä –ø–æ SSH
tail -f logs/app.log | grep -E "Creating|Reusing|closed"
```

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
curl -H "Cookie: pin_authenticated=true" \
     http://localhost:5000/api/monitoring/stats/system | jq

# –ê–∫—Ç–∏–≤–Ω—ã–µ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
curl -H "Cookie: pin_authenticated=true" \
     http://localhost:5000/api/monitoring/stats/system | \
     jq '.stats.active_ssh_connections'
```

---

### Troubleshooting

#### –ü—Ä–æ–±–ª–µ–º–∞: "SSH connection timeout"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
ping <server_ip>

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ—Ä—Ç
nc -zv <server_ip> 22

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
# UI ‚Üí Edit Server ‚Üí SSH Credentials

# 4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é
ssh username@<server_ip> -p 22
```

#### –ü—Ä–æ–±–ª–µ–º–∞: "Rate limit exceeded"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
# –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1 –º–∏–Ω—É—Ç—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞

# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ª–∏–º–∏—Ç –≤ app/routes/api.py:
# rate_limiter = RateLimiter(max_requests=20, time_window=60)  # 20 –≤–º–µ—Å—Ç–æ 10
```

#### –ü—Ä–æ–±–ª–µ–º–∞: –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ cron –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@<server_ip>
crontab -l | grep update-metrics-history

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ jq
which jq

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤—Ä—É—á–Ω—É—é
/usr/local/bin/monitoring/update-metrics-history.sh

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –∏—Å—Ç–æ—Ä–∏–∏
cat /var/tmp/metrics_history.json
```

#### –ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
netstat -tn | grep :22 | wc -l

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 1-2, –µ—Å–ª–∏ –±–æ–ª—å—à–µ:
# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Connection Pooling
tail -f logs/app.log | grep -E "Creating|Reusing"

# –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –º–Ω–æ–≥–æ "Reusing", –º–∞–ª–æ "Creating"

# 3. –£–≤–µ–ª–∏—á—å—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ templates/monitoring.html
# 30 —Å–µ–∫ ‚Üí 60 —Å–µ–∫
# 60 —Å–µ–∫ ‚Üí 120 —Å–µ–∫
# 120 —Å–µ–∫ ‚Üí 180 —Å–µ–∫
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| **SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π/–º–∏–Ω** | 60-120 | 10-15 | **6-8x –º–µ–Ω—å—à–µ** |
| **–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** | 5-60 —Å–µ–∫ | 30-120 —Å–µ–∫ | **6x —Ä–µ–∂–µ** |
| **Connection Pooling** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | **–ù–æ–≤–æ–µ** |
| **Rate Limiting** | ‚ùå –ù–µ—Ç | ‚úÖ 10/–º–∏–Ω | **–ù–æ–≤–æ–µ** |
| **Graceful Shutdown** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | **–ù–æ–≤–æ–µ** |
| **Cron –∑–∞–¥–∞—á–∞** | ‚ùå –ù–µ—Ç | ‚úÖ */5 + flock | **–ù–æ–≤–æ–µ** |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ JS** | ‚ùå –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ | ‚úÖ –°—Ç–æ–ø –ø–æ—Å–ª–µ 3 | **–ù–æ–≤–æ–µ** |
| **Health Check** | ‚ùå –ù–µ—Ç | ‚úÖ /health | **–ù–æ–≤–æ–µ** |
| **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã** | ‚ùå –ù–µ—Ç | ‚úÖ /stats/system | **–ù–æ–≤–æ–µ** |
| **–†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π | **–ö—Ä–∏—Ç–∏—á–Ω–æ** |

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –ß—Ç–æ –∏–º–µ–µ–º —Å–µ–π—á–∞—Å:

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚úÖ Connection Pooling - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SSH
- ‚úÖ Rate Limiting - 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- ‚úÖ Graceful Shutdown - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
- ‚úÖ Cron —Å flock - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ - –∞–≤—Ç–æ–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- ‚úÖ SSH Timeouts - 30/60 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã - 30-120 —Å–µ–∫—É–Ω–¥

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- ‚úÖ 5 –º–æ–¥—É–ª–µ–π –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–∞—Ñ–∏–∫, firewall, —Å–µ—Ä–≤–∏—Å—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –º–µ—Ç—Ä–∏–∫–∏)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ Health check –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ **–í 6-8 —Ä–∞–∑ –º–µ–Ω—å—à–µ** SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã** 30-120 —Å–µ–∫—É–Ω–¥
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π cron** - —Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç
- ‚úÖ **Timeout –∑–∞—â–∏—Ç–∞** - 25 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
- ‚úÖ **Connection Pooling** - –±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ –ê–≤—Ç–æ–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ Health check –¥–ª—è monitoring
- ‚úÖ Graceful Shutdown

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
- ‚úÖ 8 —à–∞–≥–æ–≤ —Å real-time –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ cron
- ‚úÖ –û—Ç–º–µ–Ω–∞ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å –æ—á–∏—Å—Ç–∫–æ–π cron

---

## üöÄ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!

**–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã.**

**–ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é! üéä**

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üîí –ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!

**üìÑ –°–º. –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ñ–∞–π–ª:** [`MONITORING_COMPLETE_CHECKLIST.md`](./MONITORING_COMPLETE_CHECKLIST.md)

–≠—Ç–æ—Ç —á–µ–∫–ª–∏—Å—Ç –∑–∞—â–∏—Ç–∏—Ç –≤–∞—Å –æ—Ç –ø–æ—Ç–µ—Ä–∏ SSH –¥–æ—Å—Ç—É–ø–∞ –∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–±–ª–µ–º:

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ UFW –≤—ã–∫–ª—é—á–µ–Ω (–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –∏ –Ω–∞–≥—Ä—É–∑–∫—É
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –≤—Ç–æ—Ä—É—é SSH —Å–µ—Å—Å–∏—é –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ò–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∫–æ–Ω—Å–æ–ª–∏ —Ö–æ—Å—Ç–∏–Ω–≥–∞

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (3 –º–∏–Ω—É—Ç—ã):

```bash
# 1. SSH —Ä–∞–±–æ—Ç–∞–µ—Ç?
ssh user@server-ip

# 2. UFW –≤—ã–∫–ª—é—á–µ–Ω? (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø!)
sudo ufw status
# ‚Üí –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: Status: inactive

# 3. –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –µ—Å—Ç—å?
df -h
# ‚Üí –î–æ–ª–∂–Ω–æ –±—ã—Ç—å > 1 GB

# 4. –°–µ—Ä–≤–µ—Ä –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω?
uptime
# ‚Üí load average < 2.0
```

### ‚úÖ –ï—Å–ª–∏ –≤—Å–µ OK ‚Üí –ú–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥!

### ‚ùå –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ ‚Üí –û—Ç–∫—Ä–æ–π—Ç–µ [`MONITORING_COMPLETE_CHECKLIST.md`](./MONITORING_COMPLETE_CHECKLIST.md)

---

### üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å

#### –ü–æ—Ç–µ—Ä—è–Ω SSH –¥–æ—Å—Ç—É–ø:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞
2. `sudo ufw disable`
3. `sudo systemctl restart sshd`

#### –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:

```bash
crontab -r && pkill -9 -f monitoring
```

#### –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
ls -la /usr/local/bin/monitoring/
crontab -l | grep monitoring
sudo /usr/local/bin/monitoring/get-all-stats.sh
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

1. **[MONITORING_COMPLETE_CHECKLIST.md](./MONITORING_COMPLETE_CHECKLIST.md)** - ‚ö†Ô∏è –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—á–∏—Ç–∞—Ç—å –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π!)
2. **[MONITORING_COMPLETE_GUIDE.md](./MONITORING_COMPLETE_GUIDE.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
3. **[MONITORING_INSTALLER_GUIDE.md](./MONITORING_INSTALLER_GUIDE.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫—É
4. **[MONITORING_INSTALLATION_PROMT.md](./MONITORING_INSTALLATION_PROMT.md)** - –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
5. **[README_MONITORING.md](./README_MONITORING.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –§–∞–π–ª—ã –∫–æ–¥–∞:

- **Backend:** `app/routes/api.py`, `app/services/ssh_service.py`, `app/utils/rate_limiter.py`
- **Frontend:** `templates/monitoring.html`, `static/css/monitoring.css`
- **Config:** `run.py`, `run_desktop.py`

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [MONITORING_COMPLETE_CHECKLIST.md](./MONITORING_COMPLETE_CHECKLIST.md)!

